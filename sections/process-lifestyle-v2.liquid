{%- comment -%}
  Section: Process - "Lifestyle Aligned"
  REVISION: 
  - Relocated "No Subscription" badge to bottom-center of the last image.
  - Refined Glassmorphism for better legibility against light backgrounds.
{%- endcomment -%}

<div class="proc-section">
  
  <div class="proc-anchor-bar">
    <div class="proc-anchor-inner">
      <div class="proc-trust-item">
        <span class="proc-trust-icon">‚ùÑÔ∏è</span>
        <span class="proc-trust-text">Cooked, Portioned & Shipped</span>
      </div>
      <div class="proc-trust-divider"></div>
      <div class="proc-trust-item">
        <span class="proc-trust-icon">üìÖ</span>
        <span class="proc-trust-text">Rotating Signature Menu</span>
      </div>
      <div class="proc-trust-divider"></div>
      <div class="proc-trust-item">
        <span class="proc-trust-icon">üá∫üá∏</span>
        <span class="proc-trust-text">USDA Inspected Kitchen</span>
      </div>
    </div>
  </div>

  <div class="proc-container">
    
    <div class="proc-header">
      {%- assign title_words = section.settings.heading | split: ' ' -%}
      {%- assign last_word = title_words.last -%}
      {%- assign first_part_size = title_words.size | minus: 1 -%}
      {%- assign first_part = title_words | slice: 0, first_part_size | join: ' ' -%}

      <h2 class="proc-headline">
        <span class="proc-rotate-group">
          {{ first_part }}<span class="proc-highlight">{{ last_word }}</span>
          
          <svg class="proc-doodle-arrow" width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M 10 5 C 35 5, 45 20, 35 50" stroke="#222222" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M 25 38 L 35 50 L 48 35" stroke="#222222" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </span>
      </h2>
      
      <div class="proc-subhead-wrap">
        <p class="proc-subhead">{{ section.settings.subheading }}</p>
      </div>
    </div>

    <div class="proc-grid-wrapper">
      <div class="proc-connector-line"></div>

      <div class="proc-grid">
        {%- for block in section.blocks -%}
          <div class="proc-item" {{ block.shopify_attributes }}>
            
            <div class="proc-visual-group">
              <div class="proc-image-frame">
                {%- if block.settings.image != blank -%}
                  {{ block.settings.image | image_url: width: 1000 | image_tag: class: 'proc-img', loading: 'lazy', alt: block.settings.title }}
                {%- else -%}
                  <div class="proc-placeholder">
                    {{ 'image' | placeholder_svg_tag: 'proc-placeholder-svg' }}
                  </div>
                {%- endif -%}

                {%- if forloop.last -%}
                  <div class="proc-no-sub-badge-centered">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>
                    <span>NO SUBSCRIPTION REQUIRED</span>
                  </div>
                {%- endif -%}
              </div>
              
              <div class="proc-step-badge">
                <span class="proc-step-num">{{ forloop.index }}</span>
              </div>
            </div>

            <div class="proc-content">
              <h3 class="proc-title">{{ block.settings.title }}</h3>
              <div class="proc-text">{{ block.settings.text }}</div>
            </div>

          </div>
        {%- endfor -%}
      </div>
    </div>

  </div>
</div>

<style>
/* --- 1. VARIABLES --- */
:root {
  --p-bg-mint: #F0F7F4;    
  --p-kale: #1E3A23;       
  --p-black: #000000;      
  --p-white: #FFFFFF;
  --p-charcoal: #222222;
  --p-grey: #555555;
  --p-red: #D11F1F;
  --p-font: 'Inter', sans-serif;
}

/* --- 2. LAYOUT --- */
.proc-section {
  background-color: var(--p-bg-mint) !important;
  width: 100% !important;
  position: relative !important;
  padding: 0 0 100px 0 !important;
  overflow: hidden !important;
  display: flex !important;
  flex-direction: column !important;
}

.proc-container {
  max-width: 1600px !important;
  margin: 0 auto !important;
  padding: 70px 40px 0 40px !important;
  box-sizing: border-box !important;
  width: 100% !important;
}

/* --- 3. THE KALE ANCHOR BAR --- */
.proc-anchor-bar {
  background-color: var(--p-kale) !important;
  width: 100% !important;
  padding: 22px 0 !important;
  position: relative !important;
  z-index: 5 !important;
}

.proc-anchor-inner {
  max-width: 1600px !important;
  margin: 0 auto !important;
  display: flex !important;
  justify-content: center !important;
  align-items: center !important;
  gap: 50px !important;
  padding: 0 40px !important;
}

.proc-trust-item {
  display: flex !important;
  align-items: center !important;
  gap: 12px !important;
  white-space: nowrap !important;
}

.proc-trust-text {
  font-family: var(--p-font) !important;
  font-weight: 700 !important;
  color: var(--p-white) !important;
  font-size: 0.85rem !important;
  text-transform: uppercase !important;
  letter-spacing: 1.8px !important;
}

.proc-trust-divider {
  width: 1px !important;
  height: 18px !important;
  background: rgba(255,255,255,0.2) !important;
}

/* --- 4. HEADER --- */
.proc-header {
  text-align: center !important;
  max-width: 800px !important;
  margin: 0 auto 75px auto !important;
  position: relative !important; 
}

.proc-headline {
  font-family: var(--p-font) !important;
  font-weight: 800 !important; 
  color: var(--p-black) !important; 
  font-size: 2.75rem !important;
  line-height: 1.1 !important;
  margin: 0 0 12px 0 !important;
  letter-spacing: -0.03em !important;
  text-transform: none !important; 
  display: flex !important;
  justify-content: center !important;
  align-items: center !important;
}

.proc-rotate-group {
  display: inline-block !important;
  transform: rotate(-1deg) !important;
  position: relative !important;
}

.proc-highlight {
  display: inline-block !important;
  background-color: var(--p-kale) !important; 
  color: var(--p-white) !important;
  padding: 2px 12px 4px 12px !important; 
  border-radius: 6px !important;
  margin-left: 6px !important; 
}

.proc-doodle-arrow {
  position: absolute !important;
  top: 50% !important;
  right: -55px !important;
  width: 50px !important;
  height: 50px !important;
  transform: translateY(-20%) rotate(0deg) !important; 
}

.proc-subhead {
  font-family: var(--p-font) !important;
  font-size: 1.2rem !important;
  color: var(--p-grey) !important;
  line-height: 1.5 !important;
  margin: 0 !important;
  font-weight: 400 !important;
}

/* --- 5. GRID & CARDS --- */
.proc-grid-wrapper {
  position: relative !important;
}

.proc-connector-line {
  position: absolute !important;
  top: 190px !important; 
  left: 5% !important;
  right: 5% !important;
  height: 2px !important;
  background-image: linear-gradient(to right, #C0C8C4 50%, rgba(255,255,255,0) 0%) !important;
  background-size: 20px 2px !important;
  background-repeat: repeat-x !important;
  opacity: 0.5 !important;
}

.proc-grid {
  display: grid !important;
  grid-template-columns: repeat(4, 1fr) !important;
  gap: 30px !important;
  position: relative !important;
  z-index: 2 !important;
  width: 100% !important;
}

.proc-item {
  display: flex !important;
  flex-direction: column !important;
  align-items: center !important;
  text-align: center !important;
  width: 100% !important;
}

.proc-visual-group {
  position: relative !important;
  width: 100% !important;
  margin: 0 auto 30px auto !important;
  aspect-ratio: 1 / 1 !important;
}

.proc-image-frame {
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  width: 100% !important;
  height: 100% !important;
  border-radius: 36px !important;
  overflow: hidden !important;
  background: white !important;
  border: 4px solid white !important;
  box-shadow: 0 20px 50px rgba(0,0,0,0.06) !important;
}

.proc-img {
  width: 100% !important;
  height: 100% !important;
  object-fit: cover !important;
  display: block !important;
}

/* --- BOTTOM-CENTERED PREMIUM BADGE --- */
.proc-no-sub-badge-centered {
  position: absolute !important;
  bottom: 40px !important; /* Positioned above the step number */
  left: 50% !important;
  transform: translateX(-50%) !important;
  
  /* Modern Styling */
  background: rgba(209, 31, 31, 0.9) !important;
  backdrop-filter: blur(12px) !important;
  -webkit-backdrop-filter: blur(12px) !important;
  color: white !important;
  padding: 8px 16px !important;
  border-radius: 100px !important;
  border: 1px solid rgba(255, 255, 255, 0.4) !important;
  
  /* Typography */
  font-family: var(--p-font) !important;
  font-weight: 700 !important;
  font-size: 0.65rem !important;
  letter-spacing: 1px !important;
  
  /* Layout */
  display: flex !important;
  align-items: center !important;
  gap: 8px !important;
  box-shadow: 0 12px 24px rgba(0,0,0,0.2) !important;
  z-index: 5 !important;
  white-space: nowrap !important;
}

.proc-step-badge {
  position: absolute !important;
  bottom: -22px !important;
  left: 50% !important;
  transform: translateX(-50%) !important;
  width: 52px !important;
  height: 52px !important;
  background: var(--p-kale) !important;
  color: white !important;
  border-radius: 50% !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  border: 5px solid var(--p-bg-mint) !important;
  z-index: 10 !important;
  box-shadow: 0 5px 15px rgba(30, 58, 35, 0.2) !important;
}

.proc-step-num {
  font-family: var(--p-font) !important;
  font-weight: 700 !important;
  font-size: 1.25rem !important;
}

.proc-title {
  font-family: var(--p-font) !important;
  font-weight: 800 !important;
  font-size: 1.35rem !important;
  color: var(--p-charcoal) !important;
  margin: 30px 0 10px 0 !important;
  letter-spacing: -0.01em !important;
  text-transform: uppercase !important;
}

.proc-text p {
  font-family: var(--p-font) !important;
  font-size: 1.1rem !important;
  color: #666 !important;
  line-height: 1.5 !important;
  max-width: 300px !important;
}

/* --- MOBILE --- */
@media (max-width: 768px) {
  .proc-container { padding: 50px 24px 0 24px !important; }
  .proc-headline { font-size: 2.2rem !important; }
  .proc-grid { grid-template-columns: 1fr !important; gap: 45px !important; }
  .proc-no-sub-badge-centered {
    bottom: 30px !important;
    padding: 6px 12px !important;
    font-size: 0.6rem !important;
  }
  .proc-doodle-arrow, .proc-connector-line { display: none !important; }
}
</style>

{% schema %}
{
  "name": "Process - Lifestyle",
  "settings": [
    { "type": "text", "id": "heading", "label": "Heading", "default": "Your New Routine" },
    { "type": "textarea", "id": "subheading", "label": "Subheading", "default": "From our kitchen to your table. Consistency made simple." }
  ],
  "blocks": [
    {
      "type": "step",
      "name": "Step",
      "limit": 4,
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Step Image" },
        { "type": "text", "id": "title", "label": "Title", "default": "Step Title" },
        { "type": "richtext", "id": "text", "label": "Text", "default": "<p>Step description.</p>" }
      ]
    }
  ],
  "presets": [
    {
      "name": "Process - Lifestyle",
      "blocks": [
        { "type": "step", "settings": { "title": "CHOOSE ONCE", "text": "<p>Pick meals that fit your goals.</p>" } },
        { "type": "step", "settings": { "title": "STAY READY", "text": "<p>We cook & ship fresh.</p>" } },
        { "type": "step", "settings": { "title": "EAT CONSISTENTLY", "text": "<p>No prep. No thinking.</p>" } },
        { "type": "step", "settings": { "title": "REPEAT", "text": "<p>Skip when you don't.</p>" } }
      ]
    }
  ]
}
{% endschema %}